; MeshNet Audio - Transmitter (TX) Node
; Tone/USB/AUX Input -> UDP Broadcast Audio Transmission
;
; NOTE: Due to spaces in the project path, this project must be copied to /tmp before building.
; Use VS Code tasks: "pio: copy and build tx" or run the copy script manually.

[env:xiao_esp32s3]
platform = espressif32
board = seeed_xiao_esp32s3
framework = espidf

; Shared library location (relative to /tmp copy location)
lib_extra_dirs = ../lib

; ESP-IDF component dependencies via registry
lib_deps = 
    k0i05/esp_ssd1306@^1.0.2
    ; TinyUSB is included in ESP-IDF framework v5.x+, configured via sdkconfig

; ESP-ADF integration
platform_packages = 
    framework-esp-idf-adf @ https://github.com/espressif/esp-adf.git#v2.6

; Build flags for hardware configuration
build_flags = 
    ; I2C pins for OLED
    -D I2C_MASTER_SCL_IO=6
    -D I2C_MASTER_SDA_IO=5
    ; Button GPIO
    -D BUTTON_GPIO=4
    ; USB Audio Class Device configuration (16kHz mono speaker)
    -D CONFIG_UAC_SAMPLE_RATE=16000
    -D CONFIG_UAC_SPEAKER_CHANNEL_NUM=1
    -D CONFIG_UAC_MIC_CHANNEL_NUM=0

; Monitor configuration
monitor_speed = 115200
monitor_filters = 
    esp32_exception_decoder

; Upload configuration for TX device
upload_port = /dev/cu.usbmodem101
upload_speed = 921600

; Debug configuration
debug_tool = esp-builtin
debug_init_break = tbreak app_main

; Board configuration
board_build.flash_mode = qio
board_build.flash_size = 8MB
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L
